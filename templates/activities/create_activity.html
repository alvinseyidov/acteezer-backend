{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page_title }} - Acteezer{% endblock %}

{% block extra_css %}
<style>
:root {
    --primary: #5DD3BE;
    --primary-dark: #4BC5AA;
    --primary-light: #7CDDC9;
    --secondary: #4DB8E8;
    --accent: #FFB84D;
    --text-dark: #1a2e2a;
    --text-gray: #64748b;
    --bg-light: #f8fdfc;
    --bg-white: #ffffff;
    --border-color: #e0f2ef;
    --gradient-primary: linear-gradient(135deg, #5DD3BE 0%, #4BC5AA 100%);
    --gradient-soft: linear-gradient(135deg, rgba(93, 211, 190, 0.1) 0%, rgba(75, 197, 170, 0.1) 100%);
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.15);
    --shadow-primary: 0 8px 25px rgba(93, 211, 190, 0.3);
    --radius: 16px;
    --radius-lg: 24px;
}

* {
    box-sizing: border-box;
}

.create-activity-wrapper {
    background: linear-gradient(135deg, #f8fdfc 0%, #f0faf8 100%);
    min-height: 100vh;
    padding: 2rem 0 4rem;
    position: relative;
    overflow-x: hidden;
}

.create-activity-wrapper::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 300px;
    background: var(--gradient-soft);
    z-index: 0;
}

.create-activity-container {
    position: relative;
    z-index: 1;
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
}

/* Breadcrumb */
.breadcrumb-modern {
    background: transparent;
    padding: 0;
    margin-bottom: 2rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.breadcrumb-modern a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.breadcrumb-modern a:hover {
    color: var(--primary-dark);
    transform: translateX(2px);
}

.breadcrumb-modern .separator {
    color: var(--text-gray);
    opacity: 0.5;
}

.breadcrumb-modern .active {
    color: var(--text-gray);
    font-weight: 600;
}

/* Hero Header */
.hero-header {
    text-align: center;
    margin-bottom: 3rem;
    padding: 2rem 0;
}

.hero-icon {
    width: 100px;
    height: 100px;
    margin: 0 auto 1.5rem;
    background: var(--gradient-primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    color: white;
    box-shadow: var(--shadow-primary);
    position: relative;
    animation: float 3s ease-in-out infinite;
}

.hero-icon::after {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 50%;
    background: var(--gradient-primary);
    opacity: 0.2;
    z-index: -1;
    animation: pulse 2s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 0.2; }
    50% { transform: scale(1.1); opacity: 0.1; }
}

.hero-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
    background: linear-gradient(135deg, var(--text-dark) 0%, var(--primary-dark) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.hero-header p {
    font-size: 1.125rem;
    color: var(--text-gray);
    margin: 0;
}

/* Main Form Card */
.form-card-modern {
    background: var(--bg-white);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    overflow: hidden;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.form-card-modern:hover {
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
}

/* Form Sections */
.form-section-modern {
    padding: 2.5rem;
    border-bottom: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.form-section-modern:last-child {
    border-bottom: none;
}

.form-section-modern:hover {
    background: linear-gradient(to right, rgba(93, 211, 190, 0.02), transparent);
}

.section-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--gradient-soft);
}

.section-icon {
    width: 50px;
    height: 50px;
    background: var(--gradient-soft);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary-dark);
    font-size: 1.5rem;
    flex-shrink: 0;
}

.section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-dark);
    margin: 0;
    flex: 1;
}

.section-description {
    font-size: 0.95rem;
    color: var(--text-gray);
    margin-top: 0.25rem;
}

/* Form Groups */
.form-group-modern {
    margin-bottom: 1.75rem;
    position: relative;
}

.form-group-modern:last-child {
    margin-bottom: 0;
}

.form-label-modern {
    display: block;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.form-label-modern .required {
    color: #FF6B6B;
    font-weight: 700;
}

/* Floating Input Style */
.form-control-modern,
.form-select-modern {
    width: 100%;
    padding: 1rem 1.25rem;
    font-size: 1rem;
    border: 2px solid var(--border-color);
    border-radius: var(--radius);
    background: var(--bg-white);
    color: var(--text-dark);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-family: 'Poppins', sans-serif;
}

.form-control-modern:focus,
.form-select-modern:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(93, 211, 190, 0.1);
    transform: translateY(-1px);
}

.form-control-modern::placeholder {
    color: var(--text-gray);
    opacity: 0.6;
}

textarea.form-control-modern {
    min-height: 140px;
    resize: vertical;
    line-height: 1.6;
}

/* Grid Layouts */
.form-grid-2 {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
}

.form-grid-3 {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
}

/* Help Text */
.form-help-modern {
    font-size: 0.875rem;
    color: var(--text-gray);
    margin-top: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    opacity: 0.8;
}

.form-help-modern i {
    font-size: 0.75rem;
    color: var(--primary);
}

/* Image Upload Area */
.image-upload-modern {
    border: 3px dashed var(--border-color);
    border-radius: var(--radius-lg);
    padding: 3rem 2rem;
    text-align: center;
    background: var(--gradient-soft);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.image-upload-modern::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--gradient-primary);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.image-upload-modern:hover {
    border-color: var(--primary);
    background: rgba(93, 211, 190, 0.05);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.image-upload-modern:hover::before {
    opacity: 0.05;
}

.image-upload-modern.dragover {
    border-color: var(--primary-dark);
    background: rgba(93, 211, 190, 0.1);
    transform: scale(1.02);
}

.upload-icon-wrapper {
    position: relative;
    z-index: 1;
    margin-bottom: 1rem;
}

.upload-icon-modern {
    font-size: 4rem;
    color: var(--primary);
    margin-bottom: 1rem;
    display: inline-block;
    transition: all 0.3s ease;
}

.image-upload-modern:hover .upload-icon-modern {
    transform: scale(1.1) rotate(5deg);
    color: var(--primary-dark);
}

.upload-text h5 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
    position: relative;
    z-index: 1;
}

.upload-text p {
    color: var(--text-gray);
    margin: 0;
    position: relative;
    z-index: 1;
}

.file-input-hidden {
    display: none;
}

/* Image Preview */
.preview-wrapper {
    margin-top: 1.5rem;
    text-align: center;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.image-preview-modern {
    max-width: 100%;
    max-height: 300px;
    border-radius: var(--radius);
    box-shadow: var(--shadow-md);
    margin-bottom: 1rem;
    border: 3px solid var(--primary-light);
}

/* Multiple Select Styling */
.select-multiple-modern {
    background: var(--bg-white);
    border: 2px solid var(--border-color);
    border-radius: var(--radius);
    padding: 0.75rem;
    min-height: 200px;
    font-size: 0.95rem;
    line-height: 1.8;
    transition: all 0.3s ease;
}

.select-multiple-modern:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(93, 211, 190, 0.1);
    outline: none;
}

.select-multiple-modern option {
    padding: 0.75rem;
    border-radius: 8px;
    margin: 0.25rem 0;
    transition: all 0.2s ease;
}

.select-multiple-modern option:checked {
    background: var(--gradient-primary);
    color: white;
    font-weight: 600;
}

.select-multiple-modern option:hover {
    background: rgba(93, 211, 190, 0.1);
}

/* Gender Selection */
.gender-selection-modern {
    background: var(--gradient-soft);
    border-radius: var(--radius);
    padding: 1.5rem;
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
}

.gender-checkbox-modern {
    display: none;
}

.gender-label-modern {
    flex: 1;
    min-width: 120px;
    padding: 1rem 1.5rem;
    background: var(--bg-white);
    border: 2px solid var(--border-color);
    border-radius: var(--radius);
    text-align: center;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-weight: 500;
    color: var(--text-dark);
    position: relative;
    overflow: hidden;
}

.gender-label-modern::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--gradient-primary);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.gender-label-modern span {
    position: relative;
    z-index: 1;
}

.gender-checkbox-modern:checked + .gender-label-modern {
    border-color: var(--primary);
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow-primary);
}

.gender-checkbox-modern:checked + .gender-label-modern::before {
    opacity: 1;
}

.gender-label-modern:hover {
    border-color: var(--primary-light);
    transform: translateY(-2px);
    box-shadow: var(--shadow-sm);
}

/* Form Footer */
.form-footer-modern {
    background: linear-gradient(135deg, rgba(93, 211, 190, 0.05) 0%, rgba(75, 197, 170, 0.02) 100%);
    padding: 2rem 2.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid var(--border-color);
    flex-wrap: wrap;
    gap: 1.5rem;
}

.footer-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-gray);
    font-size: 0.9rem;
}

.footer-info i {
    color: var(--primary);
}

.footer-actions {
    display: flex;
    gap: 1rem;
}

/* Buttons */
.btn-modern {
    padding: 1rem 2.5rem;
    font-size: 1rem;
    font-weight: 600;
    border-radius: var(--radius);
    border: none;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    font-family: 'Poppins', sans-serif;
    position: relative;
    overflow: hidden;
}

.btn-modern::before {
    content: '';
    position: absolute;
    inset: 0;
    background: white;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.btn-modern span {
    position: relative;
    z-index: 1;
}

.btn-modern i {
    position: relative;
    z-index: 1;
}

.btn-primary-modern {
    background: var(--gradient-primary);
    color: white;
    box-shadow: var(--shadow-primary);
}

.btn-primary-modern:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(93, 211, 190, 0.4);
    color: white;
}

.btn-primary-modern:active {
    transform: translateY(-1px);
}

.btn-secondary-modern {
    background: var(--bg-white);
    color: var(--text-gray);
    border: 2px solid var(--border-color);
}

.btn-secondary-modern:hover {
    background: var(--bg-light);
    border-color: var(--primary-light);
    color: var(--text-dark);
    transform: translateY(-2px);
    box-shadow: var(--shadow-sm);
}

.btn-danger-modern {
    background: #FF6B6B;
    color: white;
}

.btn-danger-modern:hover {
    background: #ff5252;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
    color: white;
}

/* Loading State */
.btn-modern.loading {
    pointer-events: none;
    opacity: 0.7;
}

.btn-modern.loading i {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Responsive */
@media (max-width: 768px) {
    .create-activity-wrapper {
        padding: 1rem 0 2rem;
    }
    
    .hero-header h1 {
        font-size: 2rem;
    }
    
    .form-section-modern {
        padding: 1.5rem;
    }
    
    .section-title {
        font-size: 1.25rem;
    }
    
    .form-grid-2,
    .form-grid-3 {
        grid-template-columns: 1fr;
    }
    
    .form-footer-modern {
        flex-direction: column;
        align-items: stretch;
    }
    
    .footer-actions {
        flex-direction: column;
    }
    
    .btn-modern {
        width: 100%;
        justify-content: center;
    }
    
    .gender-selection-modern {
        flex-direction: column;
    }
    
    .gender-label-modern {
        width: 100%;
    }
}

/* Progress Indicator */
.form-progress {
    position: sticky;
    top: 80px;
    z-index: 10;
    margin-bottom: 2rem;
}

.progress-bar-modern {
    height: 6px;
    background: var(--border-color);
    border-radius: 10px;
    overflow: hidden;
    position: relative;
}

.progress-fill {
    height: 100%;
    background: var(--gradient-primary);
    border-radius: 10px;
    transition: width 0.3s ease;
    box-shadow: 0 0 10px rgba(93, 211, 190, 0.5);
}

/* Smooth Scroll */
html {
    scroll-behavior: smooth;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 10px;
}

::-webkit-scrollbar-track {
    background: var(--bg-light);
}

::-webkit-scrollbar-thumb {
    background: var(--primary-light);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary);
}
</style>
{% endblock %}

{% block content %}
<div class="create-activity-wrapper">
    <div class="create-activity-container">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="breadcrumb-modern">
            <a href="{% url 'activities:activities_list' %}">
                <i class="fas fa-arrow-left"></i>
                <span>Aktivitələr</span>
            </a>
            <span class="separator">/</span>
            <span class="active">Yeni Aktivitə Yarat</span>
        </nav>

        <!-- Hero Header -->
        <div class="hero-header">
            <div class="hero-icon">
                <i class="fas fa-plus"></i>
            </div>
            <h1>Yeni Aktivitə Yarat</h1>
            <p>İnsanları bir araya gətirən unikal bir təcrübə yaradın</p>
        </div>

        <!-- Main Form -->
        <form method="post" enctype="multipart/form-data" id="create-activity-form" novalidate>
            {% csrf_token %}
            
            <div class="form-card-modern">
                <!-- Basic Information -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div>
                            <h3 class="section-title">Əsas Məlumatlar</h3>
                            <p class="section-description">Aktivitənizin əsas xüsusiyyətlərini daxil edin</p>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="title" class="form-label-modern">
                            Aktivitə Adı
                            <span class="required">*</span>
                        </label>
                        <input type="text" class="form-control-modern" id="title" name="title" 
                               placeholder="Məsələn: Parkda gəzinti" required maxlength="200">
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="category" class="form-label-modern">
                            Kateqoriya
                            <span class="required">*</span>
                        </label>
                        <select class="form-select-modern" id="category" name="category" required>
                            <option value="">Kateqoriya seçin</option>
                            {% for category in categories %}
                                <option value="{{ category.id }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="short_description" class="form-label-modern">
                            Qısa Təsvir
                            <span class="required">*</span>
                        </label>
                        <input type="text" class="form-control-modern" id="short_description" name="short_description" 
                               placeholder="Aktivitə kartında göstəriləcək qısa təsvir" required maxlength="300">
                        <div class="form-help-modern">
                            <i class="fas fa-info-circle"></i>
                            <span>Maksimum 300 simvol. Bu təsvir aktivitə siyahısında görünəcək.</span>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="description" class="form-label-modern">
                            Ətraflı Təsvir
                            <span class="required">*</span>
                        </label>
                        <textarea class="form-control-modern" id="description" name="description" 
                                  placeholder="Aktivitə haqqında ətraflı məlumat verin..." required></textarea>
                        <div class="form-help-modern">
                            <i class="fas fa-lightbulb"></i>
                            <span>Ətraflı təsvir iştirakçıların aktivitəni daha yaxşı başa düşməsinə kömək edir.</span>
                        </div>
                    </div>
                </div>

                <!-- Date & Time -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div>
                            <h3 class="section-title">Tarix və Vaxt</h3>
                            <p class="section-description">Aktivitənin başlama və bitmə vaxtını təyin edin</p>
                        </div>
                    </div>
                    
                    <div class="form-grid-2">
                        <div class="form-group-modern">
                            <label for="start_date" class="form-label-modern">
                                Başlama Tarixi
                                <span class="required">*</span>
                            </label>
                            <input type="date" class="form-control-modern" id="start_date" name="start_date" required autocomplete="off">
                        </div>
                        <div class="form-group-modern">
                            <label for="start_time" class="form-label-modern">
                                Başlama Vaxtı
                                <span class="required">*</span>
                            </label>
                            <input type="time" class="form-control-modern" id="start_time" name="start_time" required autocomplete="off">
                        </div>
                    </div>
                    
                    <div class="form-grid-2">
                        <div class="form-group-modern">
                            <label for="end_date" class="form-label-modern">Bitmə Tarixi</label>
                            <input type="date" class="form-control-modern" id="end_date" name="end_date" autocomplete="off">
                            <div class="form-help-modern">
                                <i class="fas fa-clock"></i>
                                <span>Boş buraxırsanız, başlama tarixindən 3 saat sonra avtomatik təyin ediləcək</span>
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label for="end_time" class="form-label-modern">Bitmə Vaxtı</label>
                            <input type="time" class="form-control-modern" id="end_time" name="end_time" autocomplete="off">
                        </div>
                    </div>
                </div>

                <!-- Location & Participants -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div>
                            <h3 class="section-title">Yer və İştirakçılar</h3>
                            <p class="section-description">Aktivitənin keçiriləcəyi yeri və iştirakçı sayını bildirin</p>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="address" class="form-label-modern">
                            Ünvan
                            <span class="required">*</span>
                        </label>
                        <input type="text" class="form-control-modern" id="address" name="address" 
                               placeholder="Məsələn: Üzeyir Hacıbəyov küçəsi, Bakı" required maxlength="300">
                        <div class="form-help-modern">
                            <i class="fas fa-map-pin"></i>
                            <span>Aktivitənin keçiriləcəyi tam ünvan</span>
                        </div>
                    </div>
                    
                    <div class="form-grid-2">
                        <div class="form-group-modern">
                            <label for="max_participants" class="form-label-modern">
                                Maksimum İştirakçı
                                <span class="required">*</span>
                            </label>
                            <input type="number" class="form-control-modern" id="max_participants" name="max_participants" 
                                   placeholder="Məs: 20" required min="2" max="1000">
                        </div>
                        <div class="form-group-modern">
                            <label for="price" class="form-label-modern">Qiymət (AZN)</label>
                            <input type="number" class="form-control-modern" id="price" name="price" 
                                   placeholder="0.00" min="0" step="0.01">
                            <div class="form-help-modern">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Pulsuzsa boş buraxın və ya 0 yazın</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Participant Requirements -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <h3 class="section-title">İştirakçı Tələbləri</h3>
                            <p class="section-description">Aktivitəyə qoşulmaq üçün tələb olunan şərtlər</p>
                        </div>
                    </div>
                    
                    <div class="form-grid-2">
                        <div class="form-group-modern">
                            <label for="min_age" class="form-label-modern">Minimum Yaş</label>
                            <input type="number" class="form-control-modern" id="min_age" name="min_age" 
                                   placeholder="Məs: 18" min="1" max="100">
                            <div class="form-help-modern">
                                <i class="fas fa-user-clock"></i>
                                <span>İsteğe bağlı - boş qoyub bütün yaşlara açığ ola bilər</span>
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label for="max_age" class="form-label-modern">Maksimum Yaş</label>
                            <input type="number" class="form-control-modern" id="max_age" name="max_age" 
                                   placeholder="Məs: 65" min="1" max="100">
                            <div class="form-help-modern">
                                <i class="fas fa-user-clock"></i>
                                <span>İsteğe bağlı - boş qoyub yaş məhdudiyyəti olmaya bilər</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="required_languages" class="form-label-modern">Tələb olunan Dillər</label>
                        <select class="select-multiple-modern" id="required_languages" name="required_languages" multiple size="8">
                            {% for language in languages %}
                                <option value="{{ language.id }}">{{ language.name }}</option>
                            {% endfor %}
                        </select>
                        <div class="form-help-modern">
                            <i class="fas fa-language"></i>
                            <span>Ctrl/Cmd basaraq bir neçə dil seçə bilərsiniz. İştirakçıların bilməli olduğu dillər</span>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label class="form-label-modern">İcazə verilən Cinsiyyətlər</label>
                        <div class="gender-selection-modern">
                            <input type="checkbox" class="gender-checkbox-modern" name="allowed_genders" value="male" id="gender_male" checked>
                            <label for="gender_male" class="gender-label-modern">
                                <span><i class="fas fa-mars me-1"></i> Kişi</span>
                            </label>
                            
                            <input type="checkbox" class="gender-checkbox-modern" name="allowed_genders" value="female" id="gender_female" checked>
                            <label for="gender_female" class="gender-label-modern">
                                <span><i class="fas fa-venus me-1"></i> Qadın</span>
                            </label>
                            
                            <input type="checkbox" class="gender-checkbox-modern" name="allowed_genders" value="other" id="gender_other" checked>
                            <label for="gender_other" class="gender-label-modern">
                                <span><i class="fas fa-transgender me-1"></i> Digər</span>
                            </label>
                            
                            <input type="checkbox" class="gender-checkbox-modern" name="allowed_genders" value="prefer_not_to_say" id="gender_prefer_not_to_say" checked>
                            <label for="gender_prefer_not_to_say" class="gender-label-modern">
                                <span><i class="fas fa-question me-1"></i> Deməyi üstün tutmuram</span>
                            </label>
                        </div>
                        <div class="form-help-modern">
                            <i class="fas fa-info-circle"></i>
                            <span>Ən az bir cinsiyyət seçilməlidir</span>
                        </div>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-list-ul"></i>
                        </div>
                        <div>
                            <h3 class="section-title">Əlavə Məlumatlar</h3>
                            <p class="section-description">İştirakçılar üçün əlavə qeydlər və tələblər</p>
                        </div>
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="requirements" class="form-label-modern">Tələblər və Qeydlər</label>
                        <textarea class="form-control-modern" id="requirements" name="requirements" 
                                  placeholder="İştirakçılar üçün xüsusi tələblər, gətirməli əşyalar və s."></textarea>
                        <div class="form-help-modern">
                            <i class="fas fa-clipboard-list"></i>
                            <span>İştirakçıların bilməli olduğu əlavə məlumatlar</span>
                        </div>
                    </div>
                </div>

                <!-- Image Upload -->
                <div class="form-section-modern">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <div>
                            <h3 class="section-title">Aktivitə Şəkli</h3>
                            <p class="section-description">Aktivitəni daha cəlbedici etmək üçün şəkil əlavə edin</p>
                        </div>
                    </div>
                    
                    <div class="image-upload-modern" onclick="document.getElementById('main_image').click()">
                        <div class="upload-icon-wrapper">
                            <i class="fas fa-cloud-upload-alt upload-icon-modern"></i>
                        </div>
                        <div class="upload-text">
                            <h5>Şəkil Yüklə</h5>
                            <p>Faylı buraya sürükləyin və ya klikləyin</p>
                        </div>
                        <input type="file" class="file-input-hidden" id="main_image" name="main_image" accept="image/*">
                    </div>
                    
                    <div class="preview-wrapper" id="preview-container" style="display: none;">
                        <img id="image-preview" class="image-preview-modern" alt="Preview">
                        <div style="margin-top: 1rem;">
                            <button type="button" class="btn-modern btn-danger-modern" onclick="removeImage()">
                                <i class="fas fa-trash"></i>
                                <span>Şəkli Sil</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Footer -->
            <div class="form-footer-modern">
                <div class="footer-info">
                    <i class="fas fa-info-circle"></i>
                    <span><span class="required">*</span> olan sahələr məcburidir</span>
                </div>
                <div class="footer-actions">
                    <a href="{% url 'activities:activities_list' %}" class="btn-modern btn-secondary-modern">
                        <i class="fas fa-times"></i>
                        <span>Ləğv et</span>
                    </a>
                    <button type="submit" class="btn-modern btn-primary-modern" id="submit-btn">
                        <i class="fas fa-plus"></i>
                        <span>Aktivitə Yarat</span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
console.log('Create activity script loaded');

// Disable HTML5 validation
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('create-activity-form');
    if (form) {
        form.setAttribute('novalidate', 'true');
        
        const formElements = form.querySelectorAll('input, select, textarea');
        formElements.forEach(element => {
            element.addEventListener('invalid', function(e) {
                e.preventDefault();
                element.setCustomValidity('');
            });
        });
    }
    
    // Set minimum date to today
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('start_date').min = today;
    document.getElementById('end_date').min = today;
    
    // Auto-fill end date based on start date
    document.getElementById('start_date').addEventListener('change', function() {
        const startDate = this.value;
        const endDateField = document.getElementById('end_date');
        if (startDate && !endDateField.value) {
            endDateField.value = startDate;
        }
    });
});

// Image upload handling
const imageInput = document.getElementById('main_image');
const uploadArea = document.querySelector('.image-upload-modern');
const previewContainer = document.getElementById('preview-container');
const imagePreview = document.getElementById('image-preview');

imageInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            imagePreview.src = e.target.result;
            previewContainer.style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
});

function removeImage() {
    imageInput.value = '';
    previewContainer.style.display = 'none';
}

// Drag and drop for image upload
uploadArea.addEventListener('dragover', function(e) {
    e.preventDefault();
    uploadArea.classList.add('dragover');
});

uploadArea.addEventListener('dragleave', function(e) {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
});

uploadArea.addEventListener('drop', function(e) {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    
    const files = e.dataTransfer.files;
    if (files.length > 0 && files[0].type.startsWith('image/')) {
        imageInput.files = files;
        imageInput.dispatchEvent(new Event('change'));
    }
});

// Language select enhancement
const languageSelect = document.getElementById('required_languages');
if (languageSelect) {
    languageSelect.addEventListener('change', function() {
        const selectedCount = this.selectedOptions.length;
        const helpText = this.parentNode.querySelector('.form-help-modern span');
        if (selectedCount > 0) {
            helpText.textContent = `${selectedCount} dil seçildi. İştirakçıların bilməli olduğu dillər`;
            helpText.style.color = 'var(--primary-dark)';
            this.classList.add('has-selections');
        } else {
            helpText.textContent = 'Ctrl/Cmd basaraq bir neçə dil seçə bilərsiniz. İştirakçıların bilməli olduğu dillər';
            helpText.style.color = '';
            this.classList.remove('has-selections');
        }
    });
}

// Form validation and submission
document.getElementById('create-activity-form').addEventListener('submit', function(e) {
    console.log('Form submission started');
    
    const submitBtn = document.getElementById('submit-btn');
    if (submitBtn.disabled) {
        e.preventDefault();
        return;
    }
    
    // Basic required field validation
    const requiredFields = ['title', 'category', 'short_description', 'description', 'start_date', 'start_time', 'address', 'max_participants'];
    let missingFields = [];
    
    for (const fieldName of requiredFields) {
        const field = document.getElementById(fieldName) || document.querySelector(`[name="${fieldName}"]`);
        if (!field || !field.value.trim()) {
            missingFields.push(fieldName);
        }
    }
    
    if (missingFields.length > 0) {
        e.preventDefault();
        alert('Zəhmət olmasa bütün məcburi sahələri doldurun: ' + missingFields.join(', '));
        return;
    }
    
    // Date validation
    const startDate = document.getElementById('start_date').value;
    const startTime = document.getElementById('start_time').value;
    const endDate = document.getElementById('end_date').value;
    const endTime = document.getElementById('end_time').value;
    
    if (startDate && startTime) {
        const startDateTime = new Date(startDate + 'T' + startTime);
        const now = new Date();
        
        if (startDateTime <= now) {
            e.preventDefault();
            alert('Aktivitə tarixi indiki vaxtdan sonra olmalıdır.');
            return;
        }
        
        if (endDate && endTime) {
            const endDateTime = new Date(endDate + 'T' + endTime);
            if (endDateTime <= startDateTime) {
                e.preventDefault();
                alert('Bitmə tarixi başlama tarixindən sonra olmalıdır.');
                return;
            }
        }
    }
    
    // Age range validation
    const minAge = document.getElementById('min_age').value;
    const maxAge = document.getElementById('max_age').value;
    if (minAge && maxAge && parseInt(minAge) >= parseInt(maxAge)) {
        e.preventDefault();
        alert('Maksimum yaş minimum yaşdan böyük olmalıdır.');
        return;
    }
    
    // Gender validation
    const genderCheckboxes = document.querySelectorAll('input[name="allowed_genders"]:checked');
    if (genderCheckboxes.length === 0) {
        e.preventDefault();
        alert('Ən az bir cinsiyyət seçməlisiniz.');
        return;
    }
    
    // Show loading state
    submitBtn.disabled = true;
    submitBtn.classList.add('loading');
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Yaradılır...</span>';
    
    // Re-enable button after timeout
    setTimeout(() => {
        submitBtn.disabled = false;
        submitBtn.classList.remove('loading');
        submitBtn.innerHTML = '<i class="fas fa-plus"></i><span>Aktivitə Yarat</span>';
    }, 60000);
});

// Clear validation messages on input
document.querySelectorAll('input, select, textarea').forEach(element => {
    element.addEventListener('input', function() {
        this.setCustomValidity('');
    });
});
</script>
{% endblock %}
