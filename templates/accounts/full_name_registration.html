{% extends 'base.html' %}
{% load static %}

{% block title %}Ad və Soyad - Acteezer{% endblock %}

{% block extra_css %}
<style>
body {
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #f0fdf9 0%, #f7fefb 100%);
    min-height: 100vh;
}

.auth-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 1rem;
}

.auth-card {
    max-width: 600px;
    width: 100%;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(20px);
    border-radius: 32px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    animation: slideUp 0.6s ease;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

.step-progress {
    padding: 2rem 2rem 1.75rem;
    background: linear-gradient(135deg, rgba(93, 211, 190, 0.05) 0%, rgba(75, 197, 170, 0.05) 100%);
}

.progress-container {
    position: relative;
}

.progress-track {
    width: 100%;
    height: 6px;
    background: #e8f0f5;
    border-radius: 10px;
    overflow: hidden;
    position: relative;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #5DD3BE 0%, #4BC5AA 100%);
    border-radius: 10px;
    transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    width: 33%;
    position: relative;
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 20px;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));
    border-radius: 0 10px 10px 0;
}

.progress-indicator {
    position: absolute;
    top: 50%;
    left: 33%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    background: white;
    border: 3px solid #4BC5AA;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(75, 197, 170, 0.3);
    z-index: 10;
    transition: left 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.progress-indicator::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 8px;
    height: 8px;
    background: #4BC5AA;
    border-radius: 50%;
}

.progress-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 1rem;
    font-size: 0.8125rem;
}

.progress-step {
    color: #4BC5AA;
    font-weight: 600;
    letter-spacing: 0.3px;
}

.progress-percentage {
    color: #94a3b8;
    font-weight: 500;
}

.auth-header {
    padding: 2.5rem 2.5rem 2rem;
    text-align: center;
}

.auth-logo {
    width: 100px;
    height: 100px;
    margin: 0 auto 1.5rem;
    background: linear-gradient(135deg, #5DD3BE 0%, #4BC5AA 100%);
    border-radius: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 10px 30px rgba(93, 211, 190, 0.4);
}

.auth-logo i {
    font-size: 2.5rem;
    color: white;
}

.auth-body {
    padding: 2rem 2.5rem 3rem;
}

.step-title {
    text-align: center;
    margin-bottom: 2rem;
}

.step-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 1rem;
    background: linear-gradient(135deg, rgba(93, 211, 190, 0.1) 0%, rgba(75, 197, 170, 0.1) 100%);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #4BC5AA;
    font-size: 2rem;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.form-label i {
    color: #4BC5AA;
    font-size: 1.1rem;
}

.form-control {
    width: 100%;
    height: 56px;
    padding: 0 1.25rem;
    font-size: 1rem;
    font-weight: 500;
    color: #1a202c;
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    transition: all 0.3s ease;
    font-family: inherit;
}

.form-control:focus {
    outline: none;
    border-color: #4BC5AA;
    background: white;
    box-shadow: 0 0 0 4px rgba(75, 197, 170, 0.1);
    transform: translateY(-1px);
}

.gender-selection {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    margin-top: 0.5rem;
}

.gender-option {
    position: relative;
    cursor: pointer;
    margin: 0;
}

.gender-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

.gender-label {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.875rem 1rem;
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    font-weight: 500;
    color: #2d3748;
    transition: all 0.3s ease;
    text-align: center;
    font-size: 0.95rem;
}

.gender-label i {
    color: #718096;
    font-size: 1rem;
}

.gender-option input[type="radio"]:checked + .gender-label {
    background: linear-gradient(135deg, rgba(93, 211, 190, 0.1) 0%, rgba(75, 197, 170, 0.1) 100%);
    border-color: #4BC5AA;
    color: #4BC5AA;
    font-weight: 600;
    box-shadow: 0 0 0 3px rgba(75, 197, 170, 0.1);
}

.gender-option input[type="radio"]:checked + .gender-label i {
    color: #4BC5AA;
}

.gender-option:hover .gender-label {
    border-color: #4BC5AA;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(75, 197, 170, 0.15);
}

.gender-error {
    margin-top: 0.75rem;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
    color: #991b1b;
    border: 1px solid #fca5a5;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    font-weight: 500;
    animation: shake 0.5s ease;
}

.gender-error i {
    color: #dc2626;
    font-size: 1rem;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

.name-preview {
    background: rgba(93, 211, 190, 0.1);
    border-left: 4px solid #4BC5AA;
    padding: 1rem 1.25rem;
    border-radius: 12px;
    margin-bottom: 1.5rem;
    text-align: center;
    display: none;
    color: #4BC5AA;
    font-weight: 600;
}

.auth-btn {
    width: 100%;
    height: 56px;
    background: linear-gradient(135deg, #5DD3BE 0%, #4BC5AA 100%);
    color: white;
    border: none;
    border-radius: 16px;
    font-size: 1.05rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    box-shadow: 0 10px 25px rgba(93, 211, 190, 0.4);
}

.auth-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 35px rgba(93, 211, 190, 0.5);
}

.back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: #718096;
    text-decoration: none;
    font-weight: 500;
    margin-top: 1rem;
    transition: all 0.3s ease;
}

.back-link:hover {
    color: #4BC5AA;
}

@media (max-width: 640px) {
    .auth-card {
        border-radius: 24px;
        margin: 0 0.5rem;
    }
    
    .auth-body {
        padding: 1.5rem 1.5rem 2rem;
    }
    
    .step-progress {
        padding: 1.5rem 1.5rem 1.25rem;
    }
    
    .progress-track {
        height: 5px;
    }
    
    .progress-indicator {
        width: 18px;
        height: 18px;
        border-width: 2.5px;
    }
    
    .progress-indicator::before {
        width: 7px;
        height: 7px;
    }
    
    .progress-info {
        font-size: 0.75rem;
        margin-top: 0.875rem;
    }
    
    .gender-selection {
        grid-template-columns: 1fr;
        gap: 0.625rem;
    }
    
    .gender-label {
        padding: 0.75rem 0.875rem;
        font-size: 0.9rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="step-progress">
            <div class="progress-container">
                <div class="progress-track">
                    <div class="progress-fill" style="width: 33%"></div>
                </div>
                <div class="progress-indicator" style="left: 33%"></div>
            </div>
            <div class="progress-info">
                <span class="progress-step">Addım 3 / 9</span>
                <span class="progress-percentage">33%</span>
            </div>
        </div>
        
        <div class="auth-body">
            <div class="step-title">
                <div class="step-icon">
                    <i class="fas fa-id-card"></i>
                </div>
                <h4 style="font-size: 1.5rem; font-weight: 700; color: #1a202c; margin-bottom: 0.5rem;">Adınızı Daxil Edin</h4>
                <p style="color: #718096;">Bu məlumat profilinizdə və aktivitələrdə göstəriləcək</p>
            </div>
            
            <form method="post" id="name-form">
                {% csrf_token %}
                
                <div class="name-preview" id="name-preview">
                    <i class="fas fa-user-circle me-2"></i>
                    <strong>Sizin adınız:</strong> <span id="preview-name">Ad Soyad</span>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="first_name" class="form-label">
                                <i class="fas fa-user"></i>
                                Adınız
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="first_name" 
                                name="first_name" 
                                placeholder="Adınız"
                                required
                                value="{{ user.first_name|default:'' }}"
                                autofocus
                            >
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="last_name" class="form-label">
                                <i class="fas fa-user"></i>
                                Soyadınız
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="last_name" 
                                name="last_name" 
                                placeholder="Soyadınız"
                                required
                                value="{{ user.last_name|default:'' }}"
                            >
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-venus-mars"></i>
                        Cinsiyyət
                    </label>
                    <div class="gender-selection">
                        <label class="gender-option">
                            <input 
                                type="radio" 
                                name="gender" 
                                value="male"
                                {% if user.gender == 'male' %}checked{% endif %}
                            >
                            <span class="gender-label">
                                <i class="fas fa-mars"></i>
                                Kişi
                            </span>
                        </label>
                        <label class="gender-option">
                            <input 
                                type="radio" 
                                name="gender" 
                                value="female"
                                {% if user.gender == 'female' %}checked{% endif %}
                            >
                            <span class="gender-label">
                                <i class="fas fa-venus"></i>
                                Qadın
                            </span>
                        </label>
                        <label class="gender-option">
                            <input 
                                type="radio" 
                                name="gender" 
                                value="other"
                                {% if user.gender == 'other' %}checked{% endif %}
                            >
                            <span class="gender-label">
                                <i class="fas fa-transgender"></i>
                                Digər
                            </span>
                        </label>
                        <label class="gender-option">
                            <input 
                                type="radio" 
                                name="gender" 
                                value="prefer_not_to_say"
                                {% if user.gender == 'prefer_not_to_say' %}checked{% endif %}
                            >
                            <span class="gender-label">
                                <i class="fas fa-question"></i>
                                Deməyi üstün tutmuram
                            </span>
                        </label>
                    </div>
                    <div class="gender-error" id="gender-error" style="display: none;">
                        <i class="fas fa-exclamation-circle"></i>
                        Zəhmət olmasa cinsiyyətinizi seçin
                    </div>
                </div>
                
                <button type="submit" class="auth-btn">
                    <i class="fas fa-arrow-right"></i>
                    Davam Et
                </button>
                
                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="{% url 'accounts:otp_verification' %}" class="back-link">
                        <i class="fas fa-arrow-left"></i>
                        Geri
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const firstName = document.getElementById('first_name');
    const lastName = document.getElementById('last_name');
    const preview = document.getElementById('name-preview');
    const previewName = document.getElementById('preview-name');
    
    function updatePreview() {
        const first = firstName.value.trim();
        const last = lastName.value.trim();
        if (first || last) {
            previewName.textContent = `${first} ${last}`.trim();
            preview.style.display = 'block';
        } else {
            preview.style.display = 'none';
        }
    }
    
    firstName.addEventListener('input', updatePreview);
    lastName.addEventListener('input', updatePreview);
    
    // Restrict to letters only
    [firstName, lastName].forEach(input => {
        input.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^a-zA-ZəƏıİöÖüÜçÇğĞşŞ\s\-]/g, '');
        });
    });
    
    // Gender validation
    const genderError = document.getElementById('gender-error');
    const genderInputs = document.querySelectorAll('input[name="gender"]');
    
    // Hide error when gender is selected
    genderInputs.forEach(input => {
        input.addEventListener('change', function() {
            genderError.style.display = 'none';
        });
    });
    
    document.getElementById('name-form').addEventListener('submit', function(e) {
        // Check if gender is selected
        const genderSelected = document.querySelector('input[name="gender"]:checked');
        
        if (!genderSelected) {
            e.preventDefault();
            genderError.style.display = 'flex';
            genderError.scrollIntoView({ behavior: 'smooth', block: 'center' });
            return false;
        }
        
        const btn = this.querySelector('button[type="submit"]');
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Yadda saxlanılır...';
        btn.disabled = true;
    });
});
</script>
{% endblock %}


